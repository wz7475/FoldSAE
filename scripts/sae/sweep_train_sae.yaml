method: grid
project: SAE_main_02
entity: RFDiffSAE
name: sae_main_02_5k_struct


program: universaldiffsae/src/scripts/train.py

command:
  - ${env}
  - SAE_DISABLE_TRITON=1
  - /home/wzarzecki/miniforge3/envs/diffsae/bin/python
  - ${program}
  - ${args}

parameters:
  dataset_path:
    value: /home/wzarzecki/ds_10000x_block_2/merged_activations
  hookpoints:
    values: [block2_non_pair, block2_pair]
  effective_batch_size:
    value: 4096
  k:
    values: [32, 64, 128, 256, 512]
  batch_topk:
    values: [True, False]
  expansion_factor:
    values: [2, 4, 8, 16, 32]
  max_trainer_steps:
    value: 50000
  lr:
     values: [0.001, 0.005, 0.0001, 0.0005, 0.00001]